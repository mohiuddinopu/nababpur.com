<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nababpur Business Finder</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
  body {
    font-family: 'Poppins', sans-serif;
    position: relative;
    min-height: 100vh;
    margin: 0;
  }

  /* Background image layer */
  body::before {
    content: "";
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: url('https://images.unsplash.com/photo-1519389950473-47ba0277781c') no-repeat center center fixed;
    background-size: cover;
    opacity: 0.3; /* 30% opacity */
    z-index: -1; /* Keep it behind everything */
  }
</style>
</head>
<body class="bg-gray-900 bg-opacity-80 text-gray-200 min-h-screen flex flex-col">

<!-- Centered Search Section -->
<main class="flex-grow flex items-center justify-center">
  <div class="w-full max-w-2xl text-center">
    <h1 class="text-4xl font-bold text-cyan-400 mb-6">Nababpur Business Finder</h1>
    <div class="relative">
      <input type="text" id="searchInput" 
        class="w-full bg-gray-800 border border-gray-700 text-gray-200 rounded-lg shadow-sm py-3 pl-4 pr-4 focus:outline-none focus:ring-2 focus:ring-cyan-500 transition duration-300"
        placeholder="Search for products or business names...">
      <div id="suggestions" class="absolute z-10 w-full bg-gray-800 border border-gray-700 rounded-lg mt-1 shadow-lg hidden max-h-60 overflow-y-auto"></div>
    </div>
    <section id="results" class="mt-10 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></section>
  </div>
</main>

<script>
async function loadConfig() {
  const res = await fetch('config.json');
  return res.json();
}

async function loadData(source) {
  if (source.type === 'local') {
    const res = await fetch(source.file);
    const text = await res.text();
    return text.split('\n').map(p => p.trim()).filter(Boolean);
  } else if (source.type === 'dynamodb') {
    // DynamoDB fetch via API Gateway or Lambda (credentials from GitHub Secrets)
    const res = await fetch(source.apiEndpoint);
    return await res.json();
  }
}

document.addEventListener('DOMContentLoaded', async () => {
  const config = await loadConfig();
  const products = await loadData(config.dataSource);

  const searchInput = document.getElementById('searchInput');
  const suggestionsContainer = document.getElementById('suggestions');
  const resultsContainer = document.getElementById('results');

  searchInput.addEventListener('input', () => {
    const query = searchInput.value.toLowerCase();
    const matches = products.filter(p => p.toLowerCase().includes(query)).slice(0, 10);
    suggestionsContainer.innerHTML = '';
    if (matches.length) {
      matches.forEach(item => {
        const div = document.createElement('div');
        div.textContent = item;
        div.className = 'p-3 hover:bg-gray-700 cursor-pointer text-gray-300';
        div.onclick = () => {
          searchInput.value = item;
          suggestionsContainer.classList.add('hidden');
          displayResults(item);
        };
        suggestionsContainer.appendChild(div);
      });
      suggestionsContainer.classList.remove('hidden');
    } else {
      suggestionsContainer.classList.add('hidden');
    }
  });

  function displayResults(query) {
    resultsContainer.innerHTML = `<div class="col-span-full text-center text-gray-500">
      <p>Showing results for "${query}"</p>
    </div>`;
  }
});
</script>
</body>
</html>
